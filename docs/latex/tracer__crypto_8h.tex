\hypertarget{tracer__crypto_8h}{}\doxysection{/home/shraiwi/\+Documents/\+Git\+Hub/tracer/main/include/tracer\+\_\+crypto.h File Reference}
\label{tracer__crypto_8h}\index{/home/shraiwi/Documents/GitHub/tracer/main/include/tracer\_crypto.h@{/home/shraiwi/Documents/GitHub/tracer/main/include/tracer\_crypto.h}}


A standard A\+PI for all of the cryptographic functions outlined in the preliminary standard (v1.\+2)  


{\ttfamily \#include \char`\"{}esp\+\_\+system.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mbedtls/sha256.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mbedtls/aes.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mbedtls/hkdf.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mbedtls/base64.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}string.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stdlib.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stdint.\+h\char`\"{}}\newline
Include dependency graph for tracer\+\_\+crypto.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tracer__crypto_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{tracer__crypto_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{tracer__crypto_8h_af92a97f32f8c618057e12fd19313760b}\label{tracer__crypto_8h_af92a97f32f8c618057e12fd19313760b}} 
\#define {\bfseries S\+H\+A256\+\_\+\+H\+A\+S\+H\+\_\+\+S\+I\+ZE}~32
\item 
\mbox{\Hypertarget{tracer__crypto_8h_a750581b20947f7691e9cb15733cc59a6}\label{tracer__crypto_8h_a750581b20947f7691e9cb15733cc59a6}} 
\#define {\bfseries A\+E\+S128\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\mbox{\Hypertarget{tracer__crypto_8h_ad22bba0ede4ca788504923556204acb8}\label{tracer__crypto_8h_ad22bba0ede4ca788504923556204acb8}} 
\#define {\bfseries A\+E\+S128\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}~16
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_ab87be64c1464ae257946085a47de8347}{zeroes\+\_\+gen}} (size\+\_\+t len, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Fills or allocates a buffer with zeroes. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_af5b3ac97a21f6b1a57fe2b2e435e2e15}{rng\+\_\+gen}} (size\+\_\+t len, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Fills or allocates a buffer with crypotgraphically-\/secure random numbers. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_ac0fcbd2b648afb9125c7ce5909fc44ae}{hkdf}} (void $\ast$key, size\+\_\+t key\+\_\+len, void $\ast$salt, size\+\_\+t salt\+\_\+len, void $\ast$info, size\+\_\+t info\+\_\+len, size\+\_\+t out\+\_\+len, void $\ast$output)
\begin{DoxyCompactList}\small\item\em A simple key-\/derivation function. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_a8bea96c38a1ee4512de161bbd4a9c3cf}{encrypt\+\_\+aes\+\_\+block}} (void $\ast$key, size\+\_\+t key\+\_\+len, void $\ast$data, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Encrypts a single block in A\+ES mode. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_a145936a52c2c85393fdd22b24638cfc0}{decrypt\+\_\+aes\+\_\+block}} (void $\ast$key, size\+\_\+t key\+\_\+len, void $\ast$data, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Decrypts a single block in A\+ES mode. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_a2e31ec2155c3ba41fa15169deecd1f05}{flip\+\_\+aes\+\_\+block\+\_\+ctr}} (void $\ast$key, size\+\_\+t key\+\_\+len, uint8\+\_\+t iv\mbox{[}16\mbox{]}, void $\ast$data, size\+\_\+t data\+\_\+len, void $\ast$output)
\begin{DoxyCompactList}\small\item\em Performs a A\+E\+S-\/\+C\+TR operation on a variable-\/length block. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{tracer__crypto_8h_a0e1f522a9ffda87ec8b79771c0a0f6a7}{b64\+\_\+encoded\+\_\+size}} (size\+\_\+t src\+\_\+size)
\begin{DoxyCompactList}\small\item\em Calculates the size of a null-\/terminated base64-\/encoded string. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{tracer__crypto_8h_a4401a8e315138e80004faf71455cca62}{b64\+\_\+decoded\+\_\+size}} (size\+\_\+t src\+\_\+size)
\begin{DoxyCompactList}\small\item\em Calculates the size of a base64-\/decoded buffer. \end{DoxyCompactList}\item 
char $\ast$ \mbox{\hyperlink{tracer__crypto_8h_ae6caed1358a482989b943d65a833e00c}{b64\+\_\+encode}} (void $\ast$data, size\+\_\+t data\+\_\+len)
\begin{DoxyCompactList}\small\item\em Converts a binary buffer to a null-\/terminated base64 string. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \mbox{\hyperlink{tracer__crypto_8h_a5373d403b4927f7e1b746dece88b6e5b}{b64\+\_\+decode}} (void $\ast$data, size\+\_\+t $\ast$out\+\_\+len)
\begin{DoxyCompactList}\small\item\em Converts a null-\/teriminated base64 string into a binary buffer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A standard A\+PI for all of the cryptographic functions outlined in the preliminary standard (v1.\+2) 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{tracer__crypto_8h_a5373d403b4927f7e1b746dece88b6e5b}\label{tracer__crypto_8h_a5373d403b4927f7e1b746dece88b6e5b}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!b64\_decode@{b64\_decode}}
\index{b64\_decode@{b64\_decode}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{b64\_decode()}{b64\_decode()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ b64\+\_\+decode (\begin{DoxyParamCaption}\item[{void $\ast$}]{data,  }\item[{size\+\_\+t $\ast$}]{out\+\_\+len }\end{DoxyParamCaption})}



Converts a null-\/teriminated base64 string into a binary buffer. 


\begin{DoxyParams}{Parameters}
{\em data} & A pointer to a buffer containing the null-\/terminated base64 string to decode. \\
\hline
{\em out\+\_\+len} & A pointer to a size\+\_\+t to write the size of the output buffer to. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a buffer containing the decoded output data. This is allocated on the heap and should be freed after use. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_a4401a8e315138e80004faf71455cca62}\label{tracer__crypto_8h_a4401a8e315138e80004faf71455cca62}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!b64\_decoded\_size@{b64\_decoded\_size}}
\index{b64\_decoded\_size@{b64\_decoded\_size}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{b64\_decoded\_size()}{b64\_decoded\_size()}}
{\footnotesize\ttfamily size\+\_\+t b64\+\_\+decoded\+\_\+size (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{src\+\_\+size }\end{DoxyParamCaption})}



Calculates the size of a base64-\/decoded buffer. 


\begin{DoxyParams}{Parameters}
{\em src\+\_\+size} & The size of the null-\/terminated source string, in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The expected size of the base64-\/decoded buffer, in bytes. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_ae6caed1358a482989b943d65a833e00c}\label{tracer__crypto_8h_ae6caed1358a482989b943d65a833e00c}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!b64\_encode@{b64\_encode}}
\index{b64\_encode@{b64\_encode}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{b64\_encode()}{b64\_encode()}}
{\footnotesize\ttfamily char$\ast$ b64\+\_\+encode (\begin{DoxyParamCaption}\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{data\+\_\+len }\end{DoxyParamCaption})}



Converts a binary buffer to a null-\/terminated base64 string. 


\begin{DoxyParams}{Parameters}
{\em data} & A pointer to a buffer containing the data to encode. \\
\hline
{\em data\+\_\+len} & The size of the data buffer, in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a null-\/terminated string containing the encoded base64 string. This is allocated on the heap and should be freed after use. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_a0e1f522a9ffda87ec8b79771c0a0f6a7}\label{tracer__crypto_8h_a0e1f522a9ffda87ec8b79771c0a0f6a7}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!b64\_encoded\_size@{b64\_encoded\_size}}
\index{b64\_encoded\_size@{b64\_encoded\_size}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{b64\_encoded\_size()}{b64\_encoded\_size()}}
{\footnotesize\ttfamily size\+\_\+t b64\+\_\+encoded\+\_\+size (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{src\+\_\+size }\end{DoxyParamCaption})}



Calculates the size of a null-\/terminated base64-\/encoded string. 


\begin{DoxyParams}{Parameters}
{\em src\+\_\+size} & The size of the source binary, in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The expected size of the null-\/terminated base64-\/encoded string, in bytes. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_a145936a52c2c85393fdd22b24638cfc0}\label{tracer__crypto_8h_a145936a52c2c85393fdd22b24638cfc0}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!decrypt\_aes\_block@{decrypt\_aes\_block}}
\index{decrypt\_aes\_block@{decrypt\_aes\_block}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{decrypt\_aes\_block()}{decrypt\_aes\_block()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ decrypt\+\_\+aes\+\_\+block (\begin{DoxyParamCaption}\item[{void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+\_\+len,  }\item[{void $\ast$}]{data,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Decrypts a single block in A\+ES mode. 

Defined as A\+E\+S128(\+Key, Data) in the standard. It uses E\+CB mode because the I\+Vs are not shared between devices.


\begin{DoxyParams}{Parameters}
{\em key} & A pointer to a buffer containing the key. \\
\hline
{\em key\+\_\+len} & The size of the key buffer, in bytes. \\
\hline
{\em data} & A pointer to a 16-\/byte long buffer containing the data to decrypt. \\
\hline
{\em output} & A pointer to where the output buffer is located. If N\+U\+LL, the function will allocate a buffer of size 16 bytes and write the decrypted data there. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a buffer containing the decrypted block. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_a8bea96c38a1ee4512de161bbd4a9c3cf}\label{tracer__crypto_8h_a8bea96c38a1ee4512de161bbd4a9c3cf}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!encrypt\_aes\_block@{encrypt\_aes\_block}}
\index{encrypt\_aes\_block@{encrypt\_aes\_block}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{encrypt\_aes\_block()}{encrypt\_aes\_block()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ encrypt\+\_\+aes\+\_\+block (\begin{DoxyParamCaption}\item[{void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+\_\+len,  }\item[{void $\ast$}]{data,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Encrypts a single block in A\+ES mode. 

Defined as A\+E\+S128(\+Key, Data) in the standard. It uses E\+CB mode because the I\+Vs are not shared between devices.


\begin{DoxyParams}{Parameters}
{\em key} & A pointer to a buffer containing the key. \\
\hline
{\em key\+\_\+len} & The size of the key buffer, in bytes. \\
\hline
{\em data} & A pointer to a 16-\/byte long buffer containing the data to encrypt. \\
\hline
{\em output} & A pointer to where the output buffer is located. If N\+U\+LL, the function will allocate a buffer of size 16 bytes and write the encrypted data there. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a buffer containing the encrypted block. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_a2e31ec2155c3ba41fa15169deecd1f05}\label{tracer__crypto_8h_a2e31ec2155c3ba41fa15169deecd1f05}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!flip\_aes\_block\_ctr@{flip\_aes\_block\_ctr}}
\index{flip\_aes\_block\_ctr@{flip\_aes\_block\_ctr}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{flip\_aes\_block\_ctr()}{flip\_aes\_block\_ctr()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ flip\+\_\+aes\+\_\+block\+\_\+ctr (\begin{DoxyParamCaption}\item[{void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+\_\+len,  }\item[{uint8\+\_\+t}]{iv\mbox{[}16\mbox{]},  }\item[{void $\ast$}]{data,  }\item[{size\+\_\+t}]{data\+\_\+len,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Performs a A\+E\+S-\/\+C\+TR operation on a variable-\/length block. 

Defined as A\+E\+S128-\/\+C\+TR(key, iv, data) in the standard. This operation is symmetrical, like X\+O\+Ring. If the operation is performed twice on the same data (with the same arguments) the original data can be recovered.


\begin{DoxyParams}{Parameters}
{\em key} & A pointer to a buffer containing the key. \\
\hline
{\em key\+\_\+len} & The size of the key buffer, in bytes. \\
\hline
{\em iv} & A pointer to a 16-\/byte buffer containing the initialization variable \\
\hline
{\em data} & A pointer to a buffer containing the data to flip. \\
\hline
{\em data\+\_\+len} & The size of the data buffer, in bytes. \\
\hline
{\em output} & A pointer to where the output buffer is located. If N\+U\+LL, the function will allocate a buffer of size {\ttfamily data\+\_\+len} and write the decrypted data there. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a buffer containing the flipped data. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_ac0fcbd2b648afb9125c7ce5909fc44ae}\label{tracer__crypto_8h_ac0fcbd2b648afb9125c7ce5909fc44ae}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!hkdf@{hkdf}}
\index{hkdf@{hkdf}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{hkdf()}{hkdf()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ hkdf (\begin{DoxyParamCaption}\item[{void $\ast$}]{key,  }\item[{size\+\_\+t}]{key\+\_\+len,  }\item[{void $\ast$}]{salt,  }\item[{size\+\_\+t}]{salt\+\_\+len,  }\item[{void $\ast$}]{info,  }\item[{size\+\_\+t}]{info\+\_\+len,  }\item[{size\+\_\+t}]{out\+\_\+len,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



A simple key-\/derivation function. 

Defined as H\+K\+D\+F(\+Key, Salt, Info, Output\+Length) in the standard. Derives an encryption key from a master key.


\begin{DoxyParams}{Parameters}
{\em key} & A pointer to a buffer containing the key. \\
\hline
{\em key\+\_\+len} & The size of the key buffer, in bytes. \\
\hline
{\em salt} & A pointer to a buffer containing the cryptographic salt. \\
\hline
{\em salt\+\_\+len} & The size of the salt buffer, in bytes. \\
\hline
{\em info} & A pointer to a buffer containing the information to be encoded in the key. \\
\hline
{\em info\+\_\+len} & The size of the info buffer, in bytes. \\
\hline
{\em out\+\_\+len} & The size of the output buffer, in bytes. \\
\hline
{\em output} & A pointer to where the output buffer is located. If N\+U\+LL, the function will allocate a buffer of size {\ttfamily out\+\_\+len} and write the key there. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to a buffer containing the output key. 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_af5b3ac97a21f6b1a57fe2b2e435e2e15}\label{tracer__crypto_8h_af5b3ac97a21f6b1a57fe2b2e435e2e15}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!rng\_gen@{rng\_gen}}
\index{rng\_gen@{rng\_gen}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{rng\_gen()}{rng\_gen()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ rng\+\_\+gen (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{len,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Fills or allocates a buffer with crypotgraphically-\/secure random numbers. 

Defined as C\+R\+N\+G(\+Output\+Length) in the standard.


\begin{DoxyParams}{Parameters}
{\em len} & The length of the buffer, in bytes \\
\hline
{\em output} & A pointer to where the buffer is located. If N\+U\+LL, the function will allocate a buffer of size {\ttfamily len} and perform the operation on it. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the given/allocated buffer 
\end{DoxyReturn}
\mbox{\Hypertarget{tracer__crypto_8h_ab87be64c1464ae257946085a47de8347}\label{tracer__crypto_8h_ab87be64c1464ae257946085a47de8347}} 
\index{tracer\_crypto.h@{tracer\_crypto.h}!zeroes\_gen@{zeroes\_gen}}
\index{zeroes\_gen@{zeroes\_gen}!tracer\_crypto.h@{tracer\_crypto.h}}
\doxysubsubsection{\texorpdfstring{zeroes\_gen()}{zeroes\_gen()}}
{\footnotesize\ttfamily uint8\+\_\+t$\ast$ zeroes\+\_\+gen (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{len,  }\item[{void $\ast$}]{output }\end{DoxyParamCaption})}



Fills or allocates a buffer with zeroes. 


\begin{DoxyParams}{Parameters}
{\em len} & The length of the buffer, in bytes. \\
\hline
{\em output} & If N\+U\+LL, the function will allocate a buffer of size {\ttfamily len} and perform the operation on it. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the given/allocated buffer 
\end{DoxyReturn}
